import"./DsnmJJEf.js";import{o as wt}from"./BB-w6zuz.js";import{p as Dt,h as Ct,l as M,a as I,b as r,c as Tt,f as k,n as v,j as u,t as ee,s as a,d as i,r as o,k as n,i as qe,m as qt,o as Se,u as St}from"./C4ENrkrF.js";import{s as E}from"./BNUiKFHq.js";import{p as tt,i as Nt}from"./Xxn1VSU5.js";import{e as At}from"./Dc6XNtIm.js";import{c as l}from"./CoQcnciM.js";import{g as Ne}from"./BsZaLcGj.js";import{r as Ae}from"./DAhJdk1q.js";import{B as te}from"./Drs0j6Za.js";import{C as jt,a as Et}from"./DyWQRENY.js";import{f as ae}from"./CWahLh_v.js";import{C as kt,a as Lt}from"./3iU5khaE.js";import{I as P}from"./BCgZte1q.js";import{L as C}from"./mup1zXrY.js";import{T as Ot,a as Ut,b as at,c as F,d as zt,e as Q}from"./DE1xQxDp.js";import{T as rt}from"./dHDU41rL.js";import{i as je}from"./Ch69Uow7.js";import{T as Bt}from"./DXqBDAri.js";var Mt=k('<div class="space-y-2"><!> <!></div>'),Ft=k("<!> <!> <!> <!> <!>",1),Qt=k("<!> <!> <!> <!> <!>",1),Rt=k("<!> <!>",1),Gt=k('<form class="space-y-6"><div class="space-y-4"><h3 class="text-lg font-medium">Client Information</h3> <div class="grid grid-cols-1 gap-4 md:grid-cols-2"><div class="space-y-2"><!> <!></div> <div class="space-y-2"><!> <!></div> <div class="space-y-2 md:col-span-2"><!> <!></div></div></div> <div class="space-y-4"><h3 class="text-lg font-medium">Invoice Details</h3> <div class="grid grid-cols-1 gap-4 md:grid-cols-3"><!> <div class="space-y-2"><!> <!></div> <div class="space-y-2"><!> <!></div></div></div> <div class="space-y-4"><div class="flex items-center justify-between"><h3 class="text-lg font-medium">Line Items</h3> <!></div> <div class="rounded-md border"><!></div></div> <div class="flex justify-end"><div class="w-full space-y-2 md:w-1/3"><div class="flex justify-between"><span class="text-muted-foreground">Subtotal:</span> <span class="font-medium"> </span></div> <div class="flex justify-between border-b pb-2"><span class="text-muted-foreground">Tax (10%):</span> <span class="font-medium"> </span></div> <div class="flex justify-between pt-2 text-lg font-semibold"><span>Total:</span> <span> </span></div></div></div> <div class="space-y-2"><!> <!></div> <div class="flex justify-end gap-4"><!> <!></div></form>'),Ht=k("<!> <!>",1);function ma(st,re){Dt(re,!0);const T=tt(re,"invoice",19,()=>({status:"draft",client:{name:"",email:"",address:""},items:[],notes:""})),q=tt(re,"isEditing",3,!1);let e=Ct({...T(),client:{...T().client},items:[...T().items||[]]});(!e.items||e.items.length===0)&&(e.items=[ie()]);let L=qe(0),R=qe(0),se=qe(0);function ie(){return{id:crypto.randomUUID(),description:"",quantity:1,rate:0,amount:0}}function it(){e.items.push(ie())}function ot(f){e.items.splice(f,1),e.items.length===0&&e.items.push(ie()),ne()}function oe(f,$,le){const G=[...e.items],w={...G[f],[$]:le};($==="quantity"||$==="rate")&&(w.amount=w.quantity*w.rate),G[f]=w,e.items=G,ne()}function ne(){!e.items||e.items.length===0||(Se(L,e.items.reduce((f,$)=>f+($.amount||0),0),!0),Se(R,Math.round(n(L)*.1),!0),Se(se,n(L)+n(R)),e.subtotal=n(L),e.tax=n(R),e.total=n(se))}function nt(){if(lt())if(q()&&T().id)je.update(T().id,e),Ne(Ae(`/admin/invoice/edit/${T().id}`));else{const f=je.add({number:je.generateInvoiceNumber(),date:new Date().toISOString().slice(0,10),dueDate:new Date(Date.now()+2592e6).toISOString().slice(0,10),status:"draft",...e});Ne(Ae(`/admin/invoice/edit/${f}`))}}function lt(){return e.client?.name?!e.items||e.items.length===0?(alert("At least one item is required"),!1):e.items.filter($=>!$.description||$.quantity<=0).length>0?(alert("All items must have a description and quantity greater than 0"),!1):!0:(alert("Client name is required"),!1)}wt(()=>{ne(),q()||(e.date=new Date().toISOString().slice(0,10),e.dueDate=new Date(Date.now()+720*60*60*1e3).toISOString().slice(0,10))});var Ee=M(),dt=I(Ee);l(dt,()=>jt,(f,$)=>{$(f,{class:"bg-gradient-to-t from-primary/5 to-card shadow-xs dark:bg-card",children:(le,G)=>{var w=Ht(),ke=I(w);l(ke,()=>kt,(de,ve)=>{ve(de,{children:(ue,ut)=>{var D=M(),O=I(D);l(O,()=>Lt,(H,U)=>{U(H,{children:(J,Le)=>{v();var S=u();ee(()=>E(S,q()?"Edit Invoice":"Create New Invoice")),r(J,S)},$$slots:{default:!0}})}),r(ue,D)},$$slots:{default:!0}})});var vt=a(ke,2);l(vt,()=>Et,(de,ve)=>{ve(de,{children:(ue,ut)=>{var D=Gt(),O=i(D),H=a(i(O),2),U=i(H),J=i(U);C(J,{for:"clientName",children:(t,d)=>{v();var s=u("Client Name*");r(t,s)},$$slots:{default:!0}});var Le=a(J,2);P(Le,{id:"clientName",required:!0,get value(){return e.client.name},set value(t){e.client.name=t}}),o(U);var S=a(U,2),Oe=i(S);C(Oe,{for:"clientEmail",children:(t,d)=>{v();var s=u("Client Email");r(t,s)},$$slots:{default:!0}});var ct=a(Oe,2);P(ct,{id:"clientEmail",type:"email",get value(){return e.client.email},set value(t){e.client.email=t}}),o(S);var Ue=a(S,2),ze=i(Ue);C(ze,{for:"clientAddress",children:(t,d)=>{v();var s=u("Client Address");r(t,s)},$$slots:{default:!0}});var mt=a(ze,2);rt(mt,{id:"clientAddress",class:"min-h-[80px]",get value(){return e.client.address},set value(t){e.client.address=t}}),o(Ue),o(H),o(O);var ce=a(O,2),Be=a(i(ce),2),Me=i(Be);{var pt=t=>{var d=Mt(),s=i(d);C(s,{for:"invoiceNumber",children:(N,xe)=>{v();var ye=u("Invoice Number");r(N,ye)},$$slots:{default:!0}});var et=a(s,2);P(et,{id:"invoiceNumber",get disabled(){return q()},get value(){return e.number},set value(N){e.number=N}}),o(d),r(t,d)};Nt(Me,t=>{q()&&t(pt)})}var me=a(Me,2),Fe=i(me);C(Fe,{for:"invoiceDate",children:(t,d)=>{v();var s=u("Issue Date");r(t,s)},$$slots:{default:!0}});var ft=a(Fe,2);P(ft,{id:"invoiceDate",type:"date",get value(){return e.date},set value(t){e.date=t}}),o(me);var Qe=a(me,2),Re=i(Qe);C(Re,{for:"dueDate",children:(t,d)=>{v();var s=u("Due Date");r(t,s)},$$slots:{default:!0}});var $t=a(Re,2);P($t,{id:"dueDate",type:"date",get value(){return e.dueDate},set value(t){e.dueDate=t}}),o(Qe),o(Be),o(ce);var pe=a(ce,2),fe=i(pe),_t=a(i(fe),2);te(_t,{type:"button",variant:"outline",size:"sm",onclick:it,children:(t,d)=>{v();var s=u("Add Item");r(t,s)},$$slots:{default:!0}}),o(fe);var Ge=a(fe,2),ht=i(Ge);l(ht,()=>Ot,(t,d)=>{d(t,{children:(s,et)=>{var N=Rt(),xe=I(N);l(xe,()=>Ut,(be,Ie)=>{Ie(be,{children:(Pe,Pt)=>{var z=M(),we=I(z);l(we,()=>at,(B,c)=>{c(B,{children:(A,De)=>{var K=Ft(),V=I(K);l(V,()=>F,(m,p)=>{p(m,{class:"w-5/12",children:(_,j)=>{v();var g=u("Description");r(_,g)},$$slots:{default:!0}})});var W=a(V,2);l(W,()=>F,(m,p)=>{p(m,{class:"w-2/12 text-right",children:(_,j)=>{v();var g=u("Quantity");r(_,g)},$$slots:{default:!0}})});var X=a(W,2);l(X,()=>F,(m,p)=>{p(m,{class:"w-2/12 text-right",children:(_,j)=>{v();var g=u("Rate");r(_,g)},$$slots:{default:!0}})});var Ce=a(X,2);l(Ce,()=>F,(m,p)=>{p(m,{class:"w-2/12 text-right",children:(_,j)=>{v();var g=u("Amount");r(_,g)},$$slots:{default:!0}})});var Y=a(Ce,2);l(Y,()=>F,(m,p)=>{p(m,{class:"w-1/12"})}),r(A,K)},$$slots:{default:!0}})}),r(Pe,z)},$$slots:{default:!0}})});var ye=a(xe,2);l(ye,()=>zt,(be,Ie)=>{Ie(be,{children:(Pe,Pt)=>{var z=M(),we=I(z);At(we,19,()=>e.items||[],B=>B.id,(B,c,A)=>{var De=M(),K=I(De);l(K,()=>at,(V,W)=>{W(V,{children:(X,Ce)=>{var Y=Qt(),m=I(Y);l(m,()=>Q,(x,y)=>{y(x,{children:(b,Z)=>{P(b,{id:"item-description",type:"text",placeholder:"Item description",oninput:()=>oe(n(A),"description",n(c).description),get value(){return n(c).description},set value(h){n(c).description=h}})},$$slots:{default:!0}})});var p=a(m,2);l(p,()=>Q,(x,y)=>{y(x,{children:(b,Z)=>{P(b,{id:"quantity",type:"number",min:"1",class:"text-right",oninput:()=>oe(n(A),"quantity",n(c).quantity),get value(){return n(c).quantity},set value(h){n(c).quantity=h}})},$$slots:{default:!0}})});var _=a(p,2);l(_,()=>Q,(x,y)=>{y(x,{children:(b,Z)=>{P(b,{id:"rate",type:"number",min:"0",step:"0.01",class:"text-right",oninput:()=>oe(n(A),"rate",n(c).rate),get value(){return n(c).rate},set value(h){n(c).rate=h}})},$$slots:{default:!0}})});var j=a(_,2);l(j,()=>Q,(x,y)=>{y(x,{class:"text-right font-medium",children:(b,Z)=>{v();var h=u();ee(Te=>E(h,Te),[()=>ae(n(c).amount)]),r(b,h)},$$slots:{default:!0}})});var g=a(j,2);l(g,()=>Q,(x,y)=>{y(x,{class:"text-center",children:(b,Z)=>{{let h=St(()=>e.items.length===1);te(b,{type:"button",variant:"ghost",size:"icon",onclick:()=>ot(n(A)),get disabled(){return n(h)},children:(Te,Jt)=>{Bt(Te,{class:"h-4 w-4 text-destructive"})},$$slots:{default:!0}})}},$$slots:{default:!0}})}),r(X,Y)},$$slots:{default:!0}})}),r(B,De)}),r(Pe,z)},$$slots:{default:!0}})}),r(s,N)},$$slots:{default:!0}})}),o(Ge),o(pe);var $e=a(pe,2),He=i($e),_e=i(He),Je=a(i(_e),2),gt=i(Je,!0);o(Je),o(_e);var he=a(_e,2),Ke=a(i(he),2),xt=i(Ke,!0);o(Ke),o(he);var Ve=a(he,2),We=a(i(Ve),2),yt=i(We,!0);o(We),o(Ve),o(He),o($e);var ge=a($e,2),Xe=i(ge);C(Xe,{for:"notes",children:(t,d)=>{v();var s=u("Notes");r(t,s)},$$slots:{default:!0}});var bt=a(Xe,2);rt(bt,{id:"notes",class:"min-h-[100px]",placeholder:"Additional notes for the client",get value(){return e.notes},set value(t){e.notes=t}}),o(ge);var Ye=a(ge,2),Ze=i(Ye);te(Ze,{type:"button",variant:"outline",onclick:()=>Ne(Ae("/admin/invoice/list")),children:(t,d)=>{v();var s=u("Cancel");r(t,s)},$$slots:{default:!0}});var It=a(Ze,2);te(It,{type:"submit",children:(t,d)=>{v();var s=u();ee(()=>E(s,q()?"Update Invoice":"Create Invoice")),r(t,s)},$$slots:{default:!0}}),o(Ye),o(D),ee((t,d,s)=>{E(gt,t),E(xt,d),E(yt,s)},[()=>ae(n(L)),()=>ae(n(R)),()=>ae(n(se))]),qt("submit",D,nt),r(ue,D)},$$slots:{default:!0}})}),r(le,w)},$$slots:{default:!0}})}),r(st,Ee),Tt()}export{ma as I};
