import{aY as k,aq as I,y as O,F as V,i as p,k as u,o as d,h as z,bF as E,u as q}from"./C4ENrkrF.js";import{b as a}from"./CfDDcxp3.js";import"./CdVPB6xn.js";import"./DNyEmou2.js";import{c as x}from"./BoVfYPwK.js";import{M as W}from"./Bw-kpFTQ.js";const N=typeof window<"u"?window:void 0;function J(r){let e=r.activeElement;for(;e?.shadowRoot;){const t=e.shadowRoot.activeElement;if(t===e)break;e=t}return e}class Q{#t;#e;constructor(e={}){const{window:t=N,document:n=t?.document}=e;t!==void 0&&(this.#t=n,this.#e=x(s=>{const i=k(t,"focusin",s),o=k(t,"focusout",s);return()=>{i(),o()}}))}get current(){return this.#e?.(),this.#t?J(this.#t):null}}new Q;function j(r,e){switch(r){case"post":O(e);break;case"pre":I(e);break}}function P(r,e,t,n={}){const{lazy:s=!1}=n;let i=!s,o=Array.isArray(r)?[]:void 0;j(e,()=>{const c=Array.isArray(r)?r.map(m=>m()):r();if(!i){i=!0,o=c;return}const l=V(()=>t(c,o));return o=c,l})}function S(r,e,t){P(r,"post",e,t)}function B(r,e,t){P(r,"pre",e,t)}S.pre=B;function U(r,e){switch(r){case"local":return e.localStorage;case"session":return e.sessionStorage}}class F{#t;#e;#n;#r;#i;#s=p(0);constructor(e,t,n={}){const{storage:s="local",serializer:i={serialize:JSON.stringify,deserialize:JSON.parse},syncTabs:o=!0,window:c=N}=n;if(this.#t=t,this.#e=e,this.#n=i,c===void 0)return;const l=U(s,c);this.#r=l;const m=l.getItem(e);m!==null?this.#t=this.#o(m):this.#u(t),o&&s==="local"&&(this.#i=x(()=>k(c,"storage",this.#c)))}get current(){this.#i?.(),u(this.#s);const e=this.#o(this.#r?.getItem(this.#e))??this.#t,t=new WeakMap,n=s=>{if(s===null||s?.constructor.name==="Date"||typeof s!="object")return s;let i=t.get(s);return i||(i=new Proxy(s,{get:(o,c)=>(u(this.#s),n(Reflect.get(o,c))),set:(o,c,l)=>(d(this.#s,u(this.#s)+1),Reflect.set(o,c,l),this.#u(e),!0)}),t.set(s,i)),i};return n(e)}set current(e){this.#u(e),d(this.#s,u(this.#s)+1)}#c=e=>{e.key!==this.#e||e.newValue===null||(this.#t=this.#o(e.newValue),d(this.#s,u(this.#s)+1))};#o(e){try{return this.#n.deserialize(e)}catch(t){console.error(`Error when parsing "${e}" from persisted store "${this.#e}"`,t);return}}#u(e){try{e!=null&&this.#r?.setItem(this.#e,this.#n.serialize(e))}catch(t){console.error(`Error when writing value from persisted store "${this.#e}" to ${this.#r}`,t)}}}function M(r){return r.filter(e=>e.length>0)}const L={getItem:r=>null,setItem:(r,e)=>{}},f=typeof document<"u",w=a("mode-watcher-mode"),y=a("mode-watcher-theme"),Y=["dark","light","system"];function T(r){return typeof r!="string"?!1:Y.includes(r)}class G{#t="system";#e=f?localStorage:L;#n=this.#e.getItem(w.current);#r=T(this.#n)?this.#n:this.#t;#i=p(z(this.#s()));#s(e=this.#r){return new F(w.current,e,{serializer:{serialize:t=>t,deserialize:t=>T(t)?t:this.#t}})}constructor(){E(()=>S.pre(()=>w.current,(e,t)=>{const n=u(this.#i).current;d(this.#i,this.#s(n),!0),t&&localStorage.removeItem(t)}))}get current(){return u(this.#i).current}set current(e){u(this.#i).current=e}}class H{#t=void 0;#e=!0;#n=p(z(this.#t));#r=typeof window<"u"&&typeof window.matchMedia=="function"?new W("prefers-color-scheme: light"):{current:!1};query(){f&&d(this.#n,this.#r.current?"light":"dark",!0)}tracking(e){this.#e=e}constructor(){E(()=>{I(()=>{this.#e&&this.query()})}),this.query=this.query.bind(this),this.tracking=this.tracking.bind(this)}get current(){return u(this.#n)}}const _=new G,K=new H;class X{#t=f?localStorage:L;#e=this.#t.getItem(y.current);#n=this.#e===null||this.#e===void 0?"":this.#e;#r=p(z(this.#i()));#i(e=this.#n){return new F(y.current,e,{serializer:{serialize:t=>typeof t!="string"?"":t,deserialize:t=>t}})}constructor(){E(()=>S.pre(()=>y.current,(e,t)=>{const n=u(this.#r).current;d(this.#r,this.#i(n),!0),t&&localStorage.removeItem(t)}))}get current(){return u(this.#r).current}set current(e){u(this.#r).current=e}}const b=new X;let A,C,v=!1,h=null;function Z(){return h||(h=document.createElement("style"),h.appendChild(document.createTextNode(`* {
		-webkit-transition: none !important;
		-moz-transition: none !important;
		-o-transition: none !important;
		-ms-transition: none !important;
		transition: none !important;
	}`)),h)}function D(r,e=!1){if(typeof document>"u")return;if(!v){v=!0,r();return}if(typeof window<"u"&&window.__vitest_worker__){r();return}clearTimeout(A),clearTimeout(C);const n=Z(),s=()=>document.head.appendChild(n),i=()=>{n.parentNode&&document.head.removeChild(n)};function o(){r(),window.requestAnimationFrame(i)}if(typeof window.requestAnimationFrame<"u"){s(),e?o():window.requestAnimationFrame(()=>{o()});return}s(),A=window.setTimeout(()=>{r(),C=window.setTimeout(i,16)},16)}const g=a(void 0),R=a(!0),$=a(!1),ee=a([]),te=a([]);function re(){const r=q(()=>{if(!f)return;const e=_.current==="system"?K.current:_.current,t=M(ee.current),n=M(te.current);function s(){const i=document.documentElement,o=document.querySelector('meta[name="theme-color"]');e==="light"?(t.length&&i.classList.remove(...t),n.length&&i.classList.add(...n),i.style.colorScheme="light",o&&g.current&&o.setAttribute("content",g.current.light)):(n.length&&i.classList.remove(...n),t.length&&i.classList.add(...t),i.style.colorScheme="dark",o&&g.current&&o.setAttribute("content",g.current.dark))}return R.current?D(s,$.current):s(),e});return{get current(){return u(r)}}}function ne(){const r=q(()=>{if(b.current,!f)return;function e(){document.documentElement.setAttribute("data-theme",b.current)}return R.current?D(e,V(()=>$.current)):e(),b.current});return{get current(){return u(r)}}}const le=re(),de=ne();export{ee as a,R as b,b as c,le as d,g as e,de as f,K as g,T as i,te as l,w as m,$ as s,y as t,_ as u};
